{% extends "base.html" %}

{% block head_end %}
  <script src="https://maps.googleapis.com/maps/api/js"></script>
{% endblock %}

{% block content %}

  <main id="content" role="main">

    <div class="row back">
      <div class="large-1 columns">
      <p><a href="/"><i class="fa fa-caret-left fa-4"></i>Back</a></p>
      </div>
    </div>

    <div class="row search">
      <form class="form" action="{{url_for('frontend.index')}}" method="POST">
        <div class="large-5 columns">
          <label class="form-label" for="name-or-id">Business name or ID number
            <span class="form-hint">For example, Kebab world or FHR1234</span>
          </label>
          {{ form.business(class_="form-control", id="name-or-id")|safe }}
          {% if form.business.errors %}
            {% for error in form.business.errors %}
              <span class="error">{{error}}</span>
            {% endfor %}
          {% endif %}
        </div>
        <div class="large-5 columns">
          <label class="form-label" for="area-or-postcode">Area or postcode
            <span class="form-hint">For example, SW4 or Croydon</span>
          </label>
          {{ form.location(class_="form-control", id="area-or-postcode")|safe }}
          {% if form.location.errors %}
            {% for error in form.location.errors %}
              <span class="error">{{error}}</span>
            {% endfor %}
          {% endif %}
        </div>
        <div class="large-2 columns">
          <input type="submit" value="Find ratings"  class="button tiny fsa-button"/>
        </div>
        {{form.csrf_token}}
      </form>
    </div>

    <div class="row">
      <div class="large-12 columns">

        <ul class="tabs result-tabs" data-tab>
          <li class="tab-title active"><a href="#list" class="wide list">List view</a></li>
          <li class="tab-title"><a href="#map" class="wide map">Map view</a></li>
        </ul>

        <div class="tabs-content">
          <div class="content active" id="list">
              <div class="large-4 columns">
                <div class="filters">
                  <p>Filter results by</p>
                </div>
              </div>
              <div class="large-8 columns">
                <p>{{results|count}} result{% if results|count > 1 %}s{% endif %} for {{request.args.business}}</p>
              </div>

              <div class="large-4 columns">
                <div class="filters">
                  <p>The actual filters</p>
                </div>
              </div>
              <div class="large-8 columns">
                <ul class="result-list">
                  {% for result in results %}
                    <li>
                      <h2 class="heading-small"><a href="/rating/FHR46250" class="business">{{result.name}}</a></h2>
                      <p><span>Premises: {{result.premises}}</span> <span>Last inspection: {{result.inspection_date}}</span> <span>Rating: {{result.rating}}</span></p>
                    </li>
                  {% endfor %}
                </ul>
              </div>
          </div>

          <div class="content" id="map">
            <div class="large-2 columns">
              <div class="filters">
                The filters panel
              </div>
            </div>

            <div class="large-10 columns">
              <div id="map-canvas"></div>
            </div>
          </div>
        </div>

      </div>
    </div>

  </main>

  {% include "footer.html" %}
{% endblock %}
